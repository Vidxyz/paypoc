apiVersion: v1
kind: ConfigMap
metadata:
  name: cart-config
  namespace: cart
data:
  application.conf: |
    play {
      http {
        secret.key = "change-me-in-production"
        secret.key = ${?PLAY_HTTP_SECRET_KEY}
      }
      server {
        http {
          port = 9002
        }
      }
      evolutions {
        enabled = true
        autoApply = true
      }
      filters {
        enabled += "play.filters.cors.CORSFilter"
      }
    }
    
    db {
      default {
        driver = "org.postgresql.Driver"
        url = "jdbc:postgresql://postgres-service.postgres.svc.cluster.local:5432/cart_db"
        username = ${DB_USERNAME}
        password = ${DB_PASSWORD}
      }
    }
    
    redis {
      host = ${REDIS_HOST}
      port = ${REDIS_PORT}
      password = ${?REDIS_PASSWORD}
      database = 0
    }
    
    kafka {
      bootstrap.servers = ${KAFKA_BOOTSTRAP_SERVERS}
      topics {
        cart.events = "cart.events"
      }
    }
    
    auth0 {
      domain = ${AUTH0_DOMAIN}
      audience = ${?AUTH0_AUDIENCE}
    }
    
    akka {
      loglevel = "INFO"
    }
    
    play.filters.cors {
      allowedOrigins = ["https://buyit.local", "https://admin.local", "https://seller.local", "http://localhost:3000", "http://localhost:3001", "http://localhost:3002", "http://localhost:5173"]
      allowedHttpMethods = ["GET", "POST", "PUT", "PATCH", "DELETE", "OPTIONS", "HEAD"]
      allowedHttpHeaders = ["Accept", "Content-Type", "Authorization", "Origin", "X-Requested-With"]
      exposedHeaders = []
      supportsCredentials = true
      preflightMaxAge = 3 days
    }
    
    play.ws.ssl {
      enabledProtocols = [ "TLSv1.2", "TLSv1.3" ]
      loose {
        acceptAnyCertificate = true
      }
    }
    
    catalog {
      service {
        url = "http://catalog-service.catalog.svc.cluster.local:8082"
        url = ${?CATALOG_SERVICE_URL}
      }
    }
    
    inventory {
      service {
        url = "http://inventory-service.inventory.svc.cluster.local:8083"
        url = ${?INVENTORY_SERVICE_URL}
        internal {
          api {
            token = ${?INVENTORY_INTERNAL_API_TOKEN}
          }
        }
      }
    }
    
    order {
      service {
        url = "http://order-service.order.svc.cluster.local:8084"
        url = ${?ORDER_SERVICE_URL}
        internal {
          api {
            token = ${?ORDER_INTERNAL_API_TOKEN}
          }
        }
      }
    }
    
    cart {
      internal {
        api {
          token = ${?CART_INTERNAL_API_TOKEN}
        }
      }
      abandonment {
        timeout {
          seconds = 3600
          seconds = ${?CART_ABANDONMENT_TIMEOUT_SECONDS}
        }
      }
    }

